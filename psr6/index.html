<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Zend\Cache">  
    <link rel="shortcut icon" href="../img/favicon.ico">

    <title>PSR-6 - zend-cache</title>

    <link rel="stylesheet" href="../css/styles-e3f3751b65.css">
</head>
<body id="page-top">

    
    <div class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">

            
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            
            <span class="navbar-brand">
                <a class="logo-link" href="https://framework.zend.com/" data-tooltip data-placement="bottom" title="Go to the ZF homepage">
                    <img src="../img/zend-framework-logo.svg" height="28" alt="Zend Framework">
                </a>
            </span>
        </div>

        <div class="navbar-collapse collapse">

            
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="https://framework.zend.com/about">About</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/downloads">Install</a>
                </li>
                <li class="active">
                    <a href="https://docs.zendframework.com">Documentation</a>
                </li>
                <li>
                    <a href="https://www.zend.com/en/services/training">Training</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/blog">Blog</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/participate">Participate</a>
                </li>
            </ul>

            
            
                <div class="nav navbar-nav navbar-collapse visible-xs-block ">
                    <div class="subnavigation hidden-print">
    <h4 class="subnavigation__title">
        <a href="..">zend-cache</a>
    </h4>

    <h5 class="subnavigation__subtitle">Table of Contents</h5>

    <ul class="subnavigation__list">
        
            
                <li class="subnavigation__list-item ">
                    <a href=".." class="subnavigation__link">zend-cache</a>
                </li>
            
        
            
                <li class="subnavigation__list-item">
                    <span class="subnavigation__headline">Storage</span>
                    <ul class="subnavigation__list">
                        
                            
    <li class="subnavigation__list-item ">
        <a href="../storage/adapter/" class="subnavigation__link">Adapters</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../storage/capabilities/" class="subnavigation__link">Capabilities</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../storage/plugin/" class="subnavigation__link">Plugins</a>
    </li>

                        
                    </ul>
                </li>
            
        
            
                <li class="subnavigation__list-item">
                    <span class="subnavigation__headline">Cache Patterns</span>
                    <ul class="subnavigation__list">
                        
                            
    <li class="subnavigation__list-item ">
        <a href="../pattern/intro/" class="subnavigation__link">Introduction</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../pattern/callback-cache/" class="subnavigation__link">CallbackCache</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../pattern/class-cache/" class="subnavigation__link">ClassCache</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../pattern/object-cache/" class="subnavigation__link">ObjectCache</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../pattern/output-cache/" class="subnavigation__link">OutputCache</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../pattern/capture-cache/" class="subnavigation__link">CaptureCache</a>
    </li>

                        
                    </ul>
                </li>
            
        
            
                <li class="subnavigation__list-item">
                    <span class="subnavigation__headline">Standards Support</span>
                    <ul class="subnavigation__list">
                        
                            
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">PSR-6</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../psr16/" class="subnavigation__link">PSR-16</a>
    </li>

                        
                    </ul>
                </li>
            
        
    </ul>
</div>
                </div>
            

            
            <div class="nav navbar-nav navbar-collapse visible-xs-block">
                <div class="component-selector">
    <h4 class="component-selector__title">Components</h4>
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
            </div>
        </div>
    </div>
</div>

    
    <header class="header">
    <div class="container">
        <div class="row">

            
            <div class="col-xs-8">
                <h1 class="header__title">
                    Documentation

                    
                        <small class="header__subtitle">zend-cache</small>
                    
                </h1>
            </div>

            
            <div class="col-xs-4 text-right">
                
                    <a href="#" class="header__link header__link--search" data-toggle="modal" data-target="#mkdocs_search_modal" title="Open search">
                        <i class="fa fa-search"></i> Search
                    </a>
                    <a href="https://github.com/zendframework/zend-cache/" class="header__link header__link--github" title="Go to repository of zend-cache">
                        <i class="fa fa-github"></i> GitHub
                    </a>
                
            </div>
        </div>
    </div>
</header>

    
    <div class="container">
        <div class="row">
            <div class="col-md-9 col-xs-12 content" role="main">
            <!-- content:begin -->
                
                    <ol class="breadcrumb" role="navigation" aria-label="breadcrumbs navigation">
  <li><a href="https://framework.zend.com/">Home</a></li>
  <li><a href="https://docs.zendframework.com/">Docs</a></li>
  <li><a href="..">zend-cache</a></li>
  
    
      
        <li>Standards Support</li>
      
    
  
  <li class="active">PSR-6</li>
</ol>


    
    

    
    
        <div class="toc">
            <h6 class="toc__headline">In This Article</h6>
            <ul class="toc__list">
                
                    <li class="toc__entry">
                        <a href="#overview" class="toc__link">Overview</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#quick-start" class="toc__link">Quick Start</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#supported-adapters" class="toc__link">Supported adapters</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#logging-errors" class="toc__link">Logging errors</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#supported-data-types" class="toc__link">Supported data types</a>
                    </li>
                
            </ul>
        </div>
    


    <h1 id="psr-6-support">PSR-6 Support</h1>
<ul>
<li>Since 2.8.0</li>
</ul>
<h2 id="overview">Overview</h2>
<p>The <code>Zend\Cache\Psr\CacheItemPool\CacheItemPoolDecorator</code> provides a <a href="https://www.php-fig.org/psr/psr-6/">PSR-6</a>
compliant wrapper for supported storage adapters.</p>
<p>PSR-6 specifies a common interface to cache storage, enabling developers to switch between implementations without
having to worry about any behind-the-scenes differences between them.</p>
<h2 id="quick-start">Quick Start</h2>
<p>To use the pool, instantiate your storage as normal, then pass it to the
<code>CacheItemPoolDecorator</code>.</p>
<pre class="codehilite"><code class="language-php">use Zend\Cache\StorageFactory;
use Zend\Cache\Psr\CacheItemPool\CacheItemPoolDecorator;

$storage = StorageFactory::factory([
    'adapter' =&gt; [
        'name'    =&gt; 'apc',
        'options' =&gt; [],
    ],
]);

$pool = new CacheItemPoolDecorator($storage);

// attempt to get an item from cache
$item = $pool-&gt;getItem('foo');

// check whether item was found
if (! $item-&gt;isHit()) {
    // ...
    // perform expensive operation to calculate $value for 'foo'
    // ...

    $item-&gt;set($value);
    $pool-&gt;save($item);
}

// use the value of the item
echo $item-&gt;get();</code></pre>

<p>Note that you will always get back a <code>CacheItem</code> object, whether it was found in cache or not: this is so <code>false</code>-y
values like an empty string, <code>null</code>, or <code>false</code> can be stored. Always check <code>isHit()</code> to determine if the item was
found.</p>
<h2 id="supported-adapters">Supported adapters</h2>
<p>The PSR-6 specification requires that the underlying storage support time-to-live (TTL), which is set when the
item is saved. For this reason the following adapters cannot be used: <code>Dba</code>, <code>Filesystem</code>, <code>Memory</code> and <code>Session</code>. The
<code>XCache</code> adapter calculates TTLs based on the request time, not the time the item is actually persisted, which means
that it also cannot be used.</p>
<p>In addition adapters must support the <code>Zend\Cache\FlushableInterface</code>. All the current <code>Zend\Cache\Storage\Adapter</code>s
fulfil this requirement.</p>
<p>Attempting to use an unsupported adapter will throw an exception implementing <code>Psr\Cache\CacheException</code>.</p>
<p>The <code>Zend\Cache\Psr\CacheItemPool\CacheItemPoolDecorator</code> adapter doesn't support driver deferred saves, so cache items are saved
on destruct or on explicit <code>commit()</code> call.</p>
<h3 id="quirks">Quirks</h3>
<h4 id="apc">APC</h4>
<p>You cannot set the <a href="http://php.net/manual/en/apc.configuration.php#ini.apc.use-request-time"><code>apc.use_request_time</code></a>
ini setting with the APC adapter: the specification requires that all TTL values are calculated from when the item is
actually saved to storage. If this is set when you instantiate the pool it will throw an exception implementing
<code>Psr\Cache\CacheException</code>. Changing the setting after you have instantiated the pool will result in non-standard
behaviour.</p>
<h2 id="logging-errors">Logging errors</h2>
<p>The specification <a href="https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-6-cache.md#error-handling">states</a>:</p>
<blockquote>
<p>While caching is often an important part of application performance, it should never be a critical part of application
functionality. Thus, an error in a cache system SHOULD NOT result in application failure.</p>
</blockquote>
<p>Once you've got your pool instance, almost all exceptions thrown by the storage will be caught and ignored. The only
storage exceptions that bubble up implement <code>Psr\Cache\InvalidArgumentException</code> and are typically caused by invalid
key errors. To be PSR-6 compliant, cache keys must not contain the following characters: <code>{}()/\@:</code>. However different
storage adapters may have further restrictions. Check the documentation for your particular adapter to be sure.</p>
<p>We strongly recommend tracking exceptions caught from storage, either by logging them or recording them in some other
way. Doing so is as simple as adding an <a href="../zend.cache.storage.plugin.html#3.4"><code>ExceptionHandler</code> plugin</a>. Say you have a
<a href="https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-3-logger-interface.md">PSR-3</a> compliant logger
called <code>$logger</code>:</p>
<pre class="codehilite"><code class="language-php">$cacheLogger = function (\Exception $e) use ($logger) {
    $message = sprintf(
        '[CACHE] %s:%s %s &quot;%s&quot;',
        $exception-&gt;getFile(),
        $exception-&gt;getLine(),
        $exception-&gt;getCode(),
        $exception-&gt;getMessage()
    );
    $logger-&gt;error($message);
};
                                }
$storage = StorageFactory::factory([
    'adapter' =&gt; [
        'name'    =&gt; 'apc',
    ],
    'plugins' =&gt; [
        'exceptionhandler' =&gt; [
            'exception_callback' =&gt; $cacheLogger,
            'throw_exceptions' =&gt; true,
        ],
    ],
]);

$pool = new CacheItemPoolDecorator($storage);</code></pre>

<p>Note that <code>throw_exceptions</code> should always be <code>true</code> (the default) or you will not get the correct return values from
calls on the pool such as <code>save()</code>.</p>
<h2 id="supported-data-types">Supported data types</h2>
<p>As per <a href="https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-6-cache.md#data">the specification</a>, the
following data types can be stored in cache: <code>string</code>, <code>integer</code>, <code>float</code>, <code>boolean</code>, <code>null</code>, <code>array</code>, <code>object</code> and be
returned as a value with exactly the same type.</p>
<p>Not all adapters can natively store all these types. For instance, Redis stores booleans and integers as a string. Where
this is the case <em>all</em> values will be automatically run through <code>serialize()</code> on save and <code>unserialize()</code> on get: you
do not need to use a <code>Zend\Cache\Storage\Plugin\Serializer</code> plugin.</p>



    <nav>
    <ul class="page-nav hidden-print">

        
        <li class="page-nav__item">
            
                <a rel="prev" class="page-nav__link page-nav__link--prev" href="../pattern/capture-cache/">
                    <i class="fa fa-chevron-left"></i> Previous
                </a>
            
        </li>

        
        <li class="page-nav__item">
            
                <a rel="next" class="page-nav__link page-nav__link--next" href="../psr16/">
                    Next <i class="fa fa-chevron-right"></i>
                </a>
            
        </li>
    </ul>
</nav>


<div class="help-wanted">
    <p>
        Found a mistake or want to contribute to the documentation?
        <a href="https://github.com/zendframework/zend-cache/edit/master/docs/book/psr6.md" target="_blank" class="help-wanted__link">
            Edit this page on GitHub!
        </a>
    </p>
</div>
                
            <!-- content:end -->
            </div>
            <div class="col-md-3 col-xs-12 sidebar">
                
                    <div class="component-selector">
    <h4 class="component-selector__title">Components</h4>
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
                    <div class="subnavigation hidden-print">
    <h4 class="subnavigation__title">
        <a href="..">zend-cache</a>
    </h4>

    <h5 class="subnavigation__subtitle">Table of Contents</h5>

    <ul class="subnavigation__list">
        
            
                <li class="subnavigation__list-item ">
                    <a href=".." class="subnavigation__link">zend-cache</a>
                </li>
            
        
            
                <li class="subnavigation__list-item">
                    <span class="subnavigation__headline">Storage</span>
                    <ul class="subnavigation__list">
                        
                            
    <li class="subnavigation__list-item ">
        <a href="../storage/adapter/" class="subnavigation__link">Adapters</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../storage/capabilities/" class="subnavigation__link">Capabilities</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../storage/plugin/" class="subnavigation__link">Plugins</a>
    </li>

                        
                    </ul>
                </li>
            
        
            
                <li class="subnavigation__list-item">
                    <span class="subnavigation__headline">Cache Patterns</span>
                    <ul class="subnavigation__list">
                        
                            
    <li class="subnavigation__list-item ">
        <a href="../pattern/intro/" class="subnavigation__link">Introduction</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../pattern/callback-cache/" class="subnavigation__link">CallbackCache</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../pattern/class-cache/" class="subnavigation__link">ClassCache</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../pattern/object-cache/" class="subnavigation__link">ObjectCache</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../pattern/output-cache/" class="subnavigation__link">OutputCache</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../pattern/capture-cache/" class="subnavigation__link">CaptureCache</a>
    </li>

                        
                    </ul>
                </li>
            
        
            
                <li class="subnavigation__list-item">
                    <span class="subnavigation__headline">Standards Support</span>
                    <ul class="subnavigation__list">
                        
                            
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">PSR-6</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../psr16/" class="subnavigation__link">PSR-16</a>
    </li>

                        
                    </ul>
                </li>
            
        
    </ul>
</div>
                
            </div>
        </div>
    </div>

    
    <footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-9">
                <h5>Zend Framework</h5>
                <ul>
                    <li><a href="https://framework.zend.com/">framework.zend.com</a></li>
                    <li><a href="https://docs.zendframework.com">docs.zendframework.com</a></li>
                    <li><a href="https://packages.zendframework.com">packages.zendframework.com</a></li>
                    <li><a href="https://apigility.org">apigility.org</a></li>
                    <li><a href="https://getexpressive.org/">getexpressive.org</a></li>
                </ul>
            </div>
        </div>

        
        <div class="row">
            <div class="col-md-12 text-center">
                <a class="footer__button" href="#page-top"><i class="fa fa-chevron-up" aria-hidden="true"></i></a>
            </div>
        </div>

        <div class="row">

            
            <div class="col-md-9">
                <h4 class="footer__headline">Copyright</h4>
                <p>&copy; 2006-2018 by <a href="https://www.zend.com/">Zend</a>, a <a href="https://www.roguewave.com/">Rogue Wave Company</a>.</p>
            </div>

            
            <div class="col-md-3">
                <h4 class="footer__headline">Support</h4>
                <ul class="support__list">
                    <li class="support__list-item">
                        <a href="https://discourse.zendframework.com" class="support__link" title="Forum"><i class="fa fa-comments"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://zendframework-slack.herokuapp.com" class="support__link" title="Chat"><i class="fa fa-slack"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://github.com/zendframework" class="support__link" title="Github"><i class="fa fa-github"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://twitter.com/zfdevteam" class="support__link" title="Twitter"><i class="fa fa-twitter"></i></a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</footer>

    <script>
        var base_url = '..',
            siteName = 'zend-cache';
    </script>
    <script src="../js/scripts-dcbafde59f.js"></script>
        <script src="../search/require.js"></script>
        <script src="../search/search.js"></script>

    
    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>



</body>


</html>
